<%doc>

=head1 NAME

/calendar/personal.mas - a page for displaying a calendar with events. A user needs to have a role in a breeding program to see that breeding program's and corresponding trials' events. 

=head1 AUTHOR

Nicolas Morales <nm529@cornell.edu>

=cut

</%doc>

<%args>
$roles => undef
$user_can_add_roles => undef
</%args>


<br/>
<center>

	<div style="width:75%">

		<& events_by_user_role.mas &>

		<div class="panel panel-success">
			<div class="panel-body">
				<p><b>Having trouble viewing events on the calendar?</b> <br/>Are you associated with the breeding program you are interested in viewing?</p>
				<a class="btn btn-primary" id="calendar_bp_user_roles_show">Calendar Permissions</a>
			</div>
		</div>

	</div>


</center>


<div class="modal fade" id="calendar_bp_user_roles_modal" name="calendar_bp_user_roles_modal" tabindex="-1" role="dialog" aria-labelledby="calendarBPRolesDialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="calendarBPRolesDialog">Calendar Permissions</h4>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
        	<h3>Permissions <small>: Events for breeding programs and their trials are accessible through the calendar to users who have a role in that breeding program. <br/><br/>Please <a href='/contact/form'>contact us</a> if you do not see your name in this table.</small></h3>
% if ($user_can_add_roles) {
	<h3>Curators can <button class="btn btn-default" id="add_person_role_button">Give User a Role</button> </h3>
% }
			<br/>

			<table id="calendar_bp_user_roles" class="table table-bordered">
			<thead>
			<tr>
			<th>Breeding Program</th>
			<th>Username</th>
			</tr>
			</thead>
			<tbody>
% foreach (@$roles) {
% if ($_->[2] ne 'submitter' && $_->[2] ne 'user' && $_->[2] ne 'curator' && $_->[2] ne 'sequencer') {
	<tr><td><% $_->[2] %></td><td><a href="/solpeople/personal-info.pl?sp_person_id=<% $_->[1] %>"><% $_->[0] %></a></td></tr>
% }
% }
			</tbody>
			</table>

        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Ok</button>
      </div>
    </div>
  </div>
</div>

 <& /people/add_person_role.mas &>

<script>

jQuery(document).ready(function() {

	jQuery('#calendar_bp_user_roles_show').click( function() {
		jQuery('#calendar_bp_user_roles_modal').modal('show');
	});

    jQuery('#calendar_bp_user_roles').DataTable();
} );

</script>
