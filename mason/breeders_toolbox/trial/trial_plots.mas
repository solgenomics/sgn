
<%args>
$trial_id
</%args>

<& /util/import_javascript.mas, classes => [ "jquery", "jqueryui", "thickbox", "CXGN.Page.FormattingHelpers", "jquery.cookie", "CXGN.List", "CXGN.BreederSearch", "CXGN.BreedersToolbox.HTMLSelect" ] &>


<div id="trial_plots_html">
</div>

<br>

<button id="select_all_plots_btn" class="btn btn-primary">Select/Deselect All</button>



<script>

jQuery(document).ready(function () {

    jQuery('#trial_plots_onswitch').one("click", function() {

        jQuery.ajax( {
            url: '/ajax/html/select/plots_from_trial',
            data: {trial_id: <% $trial_id %>},
            beforeSend: function(){
                var html = '<div class="well well-sm"><center><img src="/img/wheel.gif" /></center></div>';
                jQuery('#trial_plots_html').html(html);
            },
            success: function(response) {
            jQuery('#trial_plots_html').empty();
                jQuery('#trial_plots_html').html(response.select);

                jQuery('#plots_from_trial_select_table').DataTable({
                    paging: false,
                    searching: true,
                    ordering: true,
                    info: true,
                    scrollY: '250px',
                    scrollCollapse: true
                });
            },
            error: function(response) {
                jQuery('#trial_plots_html').html("error");
                alert("An error occurred");
            }
        });
    });

    jQuery('#select_all_plots_btn').click(function() {
        let anyChecked = jQuery('.exp_design_plot_select:checkbox:checked').length > 0;

        if (anyChecked) {
            jQuery('.exp_design_plot_select').prop("checked", false);
        } else {
            jQuery('.exp_design_plot_select').prop("checked", true);
        }
    });

});

</script>
