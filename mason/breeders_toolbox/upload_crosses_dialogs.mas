<%args>
@locations => ()
@crossing_trials => ()
</%args>

<div class="modal fade" id="upload_crosses_dialog" name="upload_crosses_dialog" tabindex="-1" role="dialog" aria-labelledby="uploadCrossesDialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="uploadCrossesDialog">Upload Crosses</h4>
            </div>
            <div class="modal-body">
                <div class="container-fluid">

                    <&| /page/explanation.mas, title=>'Template Information' &>
                        <p>
                            <b>File Format Information</b>
                            <br>
                            <a id="cross_upload_spreadsheet_format_info">Spreadsheet Format</a>
                            <br>
                        </p>
                    </&>

                    <form class="form-horizontal" role="form" method="post" enctype="multipart/form-data" encoding="multipart/form-data" id="upload_crosses_form" name="upload_crosses_form">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Crossing Trial: </label>
                            <div class="col-sm-10">
                                <select class="form-control" id="cross_upload_crossing_trial" name="cross_upload_crossing_trial">
                                    <option value="">Select Crossing Trial</option>
                                    <%perl>
                                        foreach my $crossing_trial (@crossing_trials) {
                                        print "<option value=".'"'.@$crossing_trial[0].'"'.">".@$crossing_trial[1]."</option>";
                                        }
                                    </%perl>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Location: </label>
                            <div class="col-sm-10">
                                <select class="form-control" id="cross_upload_location" name="cross_upload_location">
                                    <option value="">Select Location</option>
<%perl>
    foreach my $location (@locations) {
        print "<option value=".'"'.@$location[1].'"'.">".@$location[1]."</option>";
    }
</%perl>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Upload File: </label>
                            <div class="col-sm-10">
                                <input type="file" name="crosses_upload_file" id="crosses_upload_file" encoding="multipart/form-data" />
                            </div>
                        </div>

                        <!--
                        <hr>
                        <h3>Additional options:</h3>

                        <p>Progeny naming: <i>If generating progeny, use cross name and:</i></p>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Prefix: </label>
                            <div class="col-sm-10">
                                <input class="form-control" id="upload_prefix" name="upload_prefix" value="P" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Suffix: </label>
                            <div class="col-sm-10">
                                <input class="form-control" id="upload_suffix" name="upload_suffix" />
                            </div>
                        </div>
                        -->
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" name="upload_crosses_submit" id="upload_crosses_submit">Upload File</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="upload_cross_error_display" name="upload_cross_error_display" tabindex="-1" role="dialog" aria-labelledby="uploadCrossesErrorDialog">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="uploadCrossesErrorDialog">Upload Crosses File Error</h4>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
	  <table>
    	  <tbody></tbody>
  	  </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

% my $cross_properties = $c->config->{cross_properties};
% my @column_header = split ',',$cross_properties;

<div class="modal fade" id="cross_upload_spreadsheet_info_dialog" name="cross_upload_spreadsheet_info_dialog" tabindex="-1" role="dialog" aria-labelledby="uploadCrossesInfoDialog">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="uploadCrossesInfoDialog">Template Information</h4>
            </div>
            <div class="modal-body">
                <div class="container-fluid">

                    <b>Crosses may be uploaded in an Excel file (.xls)</b>
                    <br>
                    (.xlsx format not supported)

                    <br><br>
                    <b>Header:</b>
                    <br>

                    The first row (header) must contain the following:
                    <br>

                    <table class="table table-bordered table-hover">
                        <tbody>
                            <tr>
                                <td>cross_name</td>
                                <td>cross_type</td>
                                <td>female_parent</td>
                                <td>male_parent</td>
                                <td>female_plot</td>
                                <td>male_plot</td>
% foreach my $column_header(@column_header){
                                <td><% $column_header %></td>
%}
                            </tr>
                        </tbody>
                    </table>

                    <b>Required columns:</b>
                    <ul>
                        <li><b>cross_name</b> (must not conflict with an existing cross name)</li>
                        <li><b>cross_type</b> (must be one of the following: biparental, self, open, bulk, bulk_self, bulk_open, or doubled_haploid)</li>
                        <li><b>female_parent</b> (must exist in the database)</li>
                        <li><b>male_parent</b> (required in the header, but value may be left blank for most cross types. Must be specified for biparental and bulk crosses. When specified, must exist in the database)</li>
                    </ul>

                    <b>Optional columns (dates must be in the format YYYY/MM/DD):</b>
                    <ul>
                        <li><b>female_plot</b> (required in the header, but value may be left blank. When specified, plot name must exist in the database)</li>
                        <li><b>male_plot</b> (required in the header, but value may be left blank. When specified, plot name must exist in the database)</li>
% foreach my $column_header(@column_header){
                        <li><%$column_header%></li>
%}
                    </ul>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
